<!DOCTYPE html>
<html lang="zh-CN">
  <head>
  <meta charset="UTF-8">
  <meta 
    name="viewport"
    content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
  <meta 
    http-equiv="X-UA-Compatible" 
    content="ie=edge">
  <meta 
    name="theme-color" 
    content="#fff" 
    id="theme-color">
  <meta 
    name="description" 
    content="网络安全 Android ML CTF">
  <link 
    rel="icon" 
    href="/images/logo.png">
  <title>Note 《Structural Attack against Graph Based Android Malware Detection》</title>
  
    
      <meta 
        property="og:title" 
        content="Note 《Structural Attack against Graph Based Android Malware Detection》">
    
    
      <meta 
        property="og:url" 
        content="https://ch3nye.top/Note-Structural-Attack-against-Graph-Based-Android-Malware-Detection/index.html">
    
    
      <meta 
        property="og:img" 
        content="/images/logo.png">
    
    
      <meta 
        property="og:img" 
        content="网络安全 Android ML CTF">
    
    
      <meta 
        property="og:type" 
        content="article">
      <meta 
        property="og:article:published_time" 
        content="2022-01-29">
      <meta 
        property="og:article:modified_time" 
        content="2022-01-29">
      <meta 
        property="og:article:author" 
        content="Ch3nYe">
      
        
          <meta 
            property="og:article:tag" 
            content="Android">
        
          <meta 
            property="og:article:tag" 
            content="论文">
        
          <meta 
            property="og:article:tag" 
            content="笔记">
        
          <meta 
            property="og:article:tag" 
            content="Graph">
        
          <meta 
            property="og:article:tag" 
            content="Reinforcement-Learning">
        
          <meta 
            property="og:article:tag" 
            content="Structural-Attack">
        
          <meta 
            property="og:article:tag" 
            content="FCG">
        
          <meta 
            property="og:article:tag" 
            content="Android-Malware-Detection">
        
      
    
  
  <script>
    function loadScript(url, cb) {
      var script = document.createElement('script');
      script.src = url;
      if (cb) script.onload = cb;
      script.async = true;
      document.body.appendChild(script);
    }
    function loadCSS(href, data, attr) {
      var sheet = document.createElement('link');
      sheet.ref = 'stylesheet';
      sheet.href = href;
      sheet.dataset[data] = attr;
      document.head.appendChild(sheet);
    }
    function changeCSS(cssFile, data, attr) {
      var oldlink = document.querySelector(data);
      var newlink = document.createElement("link");
      newlink.setAttribute("rel", "stylesheet");
      newlink.setAttribute("href", cssFile);
      newlink.dataset.prism = attr;
      document.head.replaceChild(newlink, oldlink);
    }
  </script>
  
    
      
      
      
      
        
        
        
        <script>
          function prismThemeChange() {
            if(document.getElementById('theme-color').dataset.mode === 'dark') {
              if(document.querySelector('[data-prism]')) {
                changeCSS('/js/lib/prism/prism-tomorrow.min.css', '[data-prism]', 'prism-tomorrow');
              } else {
                loadCSS('/js/lib/prism/prism-tomorrow.min.css', 'prism', 'prism-tomorrow');
              }
            } else {
              if(document.querySelector('[data-prism]')) {
                changeCSS('/js/lib/prism/prism.min.css', '[data-prism]', 'prism');
              } else {
                loadCSS('/js/lib/prism/prism.min.css', 'prism', 'prism');
              }
            }
          }
          prismThemeChange()
        </script>
      
      
        
        <link rel="stylesheet" href="/js/lib/prism/prism-line-numbers.min.css">
      
    
  
  <script>
    // control reverse button
    var reverseDarkList = {
      dark: 'light',
      light: 'dark'
    };
    var themeColor = {
      dark: '#1c1c1e',
      light: '#fff'
    }
    // get the data of css prefers-color-scheme
    var getCssMediaQuery = function() {
      return window.matchMedia('(prefers-color-scheme: dark)').matches ? 'dark' : 'light';
    };
    // reverse current darkmode setting function
    var reverseDarkModeSetting = function() {
      var setting = localStorage.getItem('user-color-scheme');
      if(reverseDarkList[setting]) {
        setting = reverseDarkList[setting];
      } else if(setting === null) {
        setting = reverseDarkList[getCssMediaQuery()];
      } else {
        return;
      }
      localStorage.setItem('user-color-scheme', setting);
      return setting;
    };
    // apply current darkmode setting
  </script>
  
    <script>
      var setDarkmode = function(mode) {
      var setting = mode || localStorage.getItem('user-color-scheme');
      if(setting === getCssMediaQuery()) {
        document.documentElement.removeAttribute('data-user-color-scheme');
        localStorage.removeItem('user-color-scheme');
        document.getElementById('theme-color').content = themeColor[setting];
        document.getElementById('theme-color').dataset.mode = setting;
        prismThemeChange();
      } else if(reverseDarkList[setting]) {
        document.documentElement.setAttribute('data-user-color-scheme', setting);
        document.getElementById('theme-color').content = themeColor[setting];
        document.getElementById('theme-color').dataset.mode = setting;
        prismThemeChange();
      } else {
        document.documentElement.removeAttribute('data-user-color-scheme');
        localStorage.removeItem('user-color-scheme');
        document.getElementById('theme-color').content = themeColor[getCssMediaQuery()];
        document.getElementById('theme-color').dataset.mode = getCssMediaQuery();
        prismThemeChange();
      }
    };
    setDarkmode();
    </script>
  
  
  <link rel="preload" href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css" as="style" >
  <link rel="preload" href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css" as="style" >
  
  
    <link rel="preload" href="/js/lib/lightbox/baguetteBox.min.js" as="script">
    <link rel="preload" href="/js/lib/lightbox/baguetteBox.min.css" as="style" >
  
  
    <link rel="preload" href="/js/lib/lozad.min.js" as="script">
  
  
  
  
    
    <link rel="prefetch" href="//cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" as="script">
  
  
    
    <link rel="prefetch" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js" as="script">
  
  
  
  <link rel="stylesheet" href="/css/main.css">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1946621_i1kgafibvw.css">
  
  <link rel="stylesheet" href="//at.alicdn.com/t/font_1952792_89b4ac4k4up.css">
  
    <link rel="stylesheet" href="/js/lib/lightbox/baguetteBox.min.css">
  
<meta name="generator" content="Hexo 5.3.0"></head>

  <body>
    <div class="wrapper">
       
      <nav class="navbar">
  <div class="navbar-logo">
    <span class="navbar-logo-main">
      
        <img 
          class="navbar-logo-img"
          width="32"
          height="32"
          src="/images/logo.png" 
          alt="blog logo">
      
      <span class="navbar-logo-dsc">ch3nye's blog</span>
    </span>
  </div>
  <div class="navbar-menu">
    
      <a 
        href="/" 
        class="navbar-menu-item">
        
          首页
        
      </a>
    
      <a 
        href="/archives" 
        class="navbar-menu-item">
        
          归档
        
      </a>
    
      <a 
        href="/tags" 
        class="navbar-menu-item">
        
          标签
        
      </a>
    
      <a 
        href="/categories" 
        class="navbar-menu-item">
        
          分类
        
      </a>
    
      <a 
        href="/about" 
        class="navbar-menu-item">
        
          关于
        
      </a>
    
      <a 
        href="/links" 
        class="navbar-menu-item">
        
          友链
        
      </a>
    
      <a 
        href="/shuoshuo" 
        class="navbar-menu-item">
        
          说说
        
      </a>
    
    <a 
      class="navbar-menu-item darknavbar" 
      id="dark">
      <i class="iconfont icon-weather"></i>
    </a>
    <a 
      class="navbar-menu-item searchnavbar" 
      id="search">
      <i 
        class="iconfont icon-search" 
        style="font-size: 1.2rem; font-weight: 400;">
      </i>
    </a>
  </div>
</nav> 
      
      <div 
        id="local-search" 
        style="display: none">
        <input
          class="navbar-menu-item"
          id="search-input"
          placeholder="请输入搜索内容..." />
        <div id="search-content"></div>
      </div>
      
      <div class="section-wrap">
        <div class="container">
          <div class="columns">
            <main class="main-column">
<article class="card card-content">
  <header>
    <h1 class="post-title">
      Note 《Structural Attack against Graph Based Android Malware Detection》
    </h1>
  </header>
  <div class="post-meta post-show-meta">
    <time datetime="2022-01-28T16:00:00.000Z">
      <i 
        class="iconfont icon-calendar" 
        style="margin-right: 2px;">
      </i>
      <span>2022-01-29</span>
    </time>
    
      <span class="dot"></span>
      
        <a 
          href="/categories/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/" 
          class="post-meta-link">
          论文阅读
        </a>
      
    
    
      <span class="dot"></span>
      <span>4.5k 字</span>
    
  </div>
  
    <div 
      class="post-meta post-show-meta" 
      style="margin-top: -10px;">
      <div style="display: flex; align-items: center;">
        <i 
          class="iconfont icon-biaoqian" 
          style="margin-right: 2px; font-size: 1.15rem;">
        </i>
        
          
          <a 
            href="/tags/Android/" 
            class="post-meta-link">
            Android
          </a>
        
          
            <span class="dot"></span>
          
          <a 
            href="/tags/%E8%AE%BA%E6%96%87/" 
            class="post-meta-link">
            论文
          </a>
        
          
            <span class="dot"></span>
          
          <a 
            href="/tags/%E7%AC%94%E8%AE%B0/" 
            class="post-meta-link">
            笔记
          </a>
        
          
            <span class="dot"></span>
          
          <a 
            href="/tags/Graph/" 
            class="post-meta-link">
            Graph
          </a>
        
          
            <span class="dot"></span>
          
          <a 
            href="/tags/Reinforcement-Learning/" 
            class="post-meta-link">
            Reinforcement-Learning
          </a>
        
          
            <span class="dot"></span>
          
          <a 
            href="/tags/Structural-Attack/" 
            class="post-meta-link">
            Structural-Attack
          </a>
        
          
            <span class="dot"></span>
          
          <a 
            href="/tags/FCG/" 
            class="post-meta-link">
            FCG
          </a>
        
          
            <span class="dot"></span>
          
          <a 
            href="/tags/Android-Malware-Detection/" 
            class="post-meta-link">
            Android-Malware-Detection
          </a>
        
      </div>
    </div>
  
  </header>
  <div 
    id="section" 
    class="post-content">
    <h1 id="structural-attack-against-graph-based-android-malware-detection"><a class="markdownIt-Anchor" href="#structural-attack-against-graph-based-android-malware-detection"></a> Structural Attack against Graph Based Android Malware Detection</h1>
<h2 id="主要解决什么问题"><a class="markdownIt-Anchor" href="#主要解决什么问题"></a> 主要解决什么问题</h2>
<p>目前有很多基于函数调用图FCG的恶意软件检测方法，本文提出一种结构攻击方法，攻击基于图的Android恶意软件检测器. 解决了feature space和problem space之间的逆变换问题[1].</p>
<p>这里写一下我对这两个空间和两者之间变换的理解：</p>
<ul>
<li>特征空间feature space：原始输入（比如image，pdf，software）通过特征映射函数得到的特征向量，也就是数值向量.</li>
<li>问题空间problem space：（不知道这样翻译是否准确）指原始输入.</li>
<li>两者之间的变换：从样本空间到特征向量空间的映射，和，从特征向量空间到样本空间的映射.</li>
<li>值得说明的是，从原始输入计算特征向量的这个映射函数，它往往不是双射的，比如从一个软件的函数调用图上生成特征向量的映射函数，任意给出一个向量大概率找不到对应的函数调用图. 这意味着一个特征空间的向量叠加上扰动以后，很可能没有对应的problem space中的样本. 这就使得Inverse Feature-Mapping Problem成了一个难题.</li>
</ul>
<blockquote>
<p>这篇文章[1]对上述概念进行了较为详细的阐述和形式化表达，如果想进一步深入了解，可以通过文末链接阅读原文. 文中Sec III对两个space上的攻击，space之间的变换，<strong>变换的难点，以及可能的解决的方法</strong>（在段落B.Inverse Feature-Mapping Problem）进行了形式化描述.<br />
有趣的是，这篇文章Sec IV直接使用问题空间攻击，在Andorid恶意程序检测模型上进行攻击尝试.</p>
</blockquote>
<p>回到本文，</p>
<p>设计了一个启发式优化模型与强化学习框架集成到一起，用于优化我们的结构攻击(HRAT：Heuristic optimization model integrated with Reinforcement learning framework structural ATtack). HRAT包括四种类型的攻击：插入和删除节点，增加边和改写，对应APP中的插入和删除方法，增加调用关系和改写.</p>
<p>通过对超过 30k Android 应用程序的广泛实验，HRAT在feature space（超过 90% 的攻击成功率）和problem space（多数情况下高达 100% 的攻击成功率）都展示了出色的攻击性能.</p>
<p>另外，需要阐述本文要解决的现有的对抗样本攻击方法的问题：</p>
<ul>
<li>
<p>L1-system-specifc attack methods：现存的攻击方法多数高度依赖目标系统的特征提取方法，比如Android HIV实现了problem space attack on Mamadroid 通过修改某些样本特征，以扰动特征向量，所以如果目标系统更换特征提取方法，那需要重新设计problem space transformation（这里的变换指problem space中原始样本到对抗样本的变换）. 本文structural attack 扰动图结构而不是特征向量，所以目标系统的特征提取方法对本文攻击工作流无影响.</p>
<p>（怎么会没有影响呢，那我要是不从函数调用图上提取特征了，你还能生成个球的对抗样本. 所以我觉得，在problem space的扰动，最终还是对特征向量的扰动，是不能绕靠目标系统更换特征提取方法这个问题的.）</p>
</li>
<li>
<p>L2-limited software modification operations：为了保持功能的一致性，现有的 App 修改方法仅限于插入死代码.</p>
</li>
<li>
<p>L3-inconsistent transformation relation：现存的对抗样本的生成方法以特征扰动到app modification为指导，尽管他们可以按照需要随意插入代码，但是为了一致性（或者说Plausibility）只能插入no-op code无动作代码. 而我们的攻击方法确保了修改图后仍能保持应用程序的一致性. （其实这条和上一条不是一个意思吗.</p>
</li>
</ul>
<p>其实上述L3在[1]中段落Problem-Space Constraints也有提到，就是关于问题空间transformation生成对抗样本的约束条件.</p>
<p><strong>challenges</strong></p>
<ul>
<li>how to determine a operation type.</li>
<li>how to select the most effective objects (nodes or edges) to modify.</li>
</ul>
<p>为此设计了本文HRAT，原文Sec 3.3对上述问题的解决进行了描述.</p>
<hr />
<p>总结：</p>
<p><img src="/images/HRAT1.png" alt="HRAT1" / srcset="/images/LoadingImage.gif" data-src="/images/HRAT1.png" class="lozad post-image"></p>
<p>本文要解决的问题就是右下角的问号.</p>
<h2 id="目标系统"><a class="markdownIt-Anchor" href="#目标系统"></a> 目标系统</h2>
<p>默认大家都对下述Android恶意程序检测工作有基本的了解，这里就简要地提一下.</p>
<h3 id="malscan"><a class="markdownIt-Anchor" href="#malscan"></a> Malscan</h3>
<p>从app和提取FCGs图，并使用图上敏感节点的中心作为特征. 所谓敏感节点就是能反应恶意软件性质的android敏感APIs.</p>
<h3 id="mamadroid"><a class="markdownIt-Anchor" href="#mamadroid"></a> Mamadroid</h3>
<p>从FCG中抽取函数调用关系作为特征.</p>
<h3 id="apigraph"><a class="markdownIt-Anchor" href="#apigraph"></a> APIGraph</h3>
<p>是一个提升Android Malware Detection的框架. 它增强了特征的表征能力，并利用Android的特性聚合具有相似语义的API. 也就是做API聚类，在特征提取过程中，使用一个代表性API表示一个cluster中的所有API.</p>
<h2 id="攻击方法"><a class="markdownIt-Anchor" href="#攻击方法"></a> 攻击方法</h2>
<h3 id="威胁模型"><a class="markdownIt-Anchor" href="#威胁模型"></a> 威胁模型</h3>
<p>目标系统攻击这来说是可访问的白盒. 也就是说，攻击者可以访问目标系统的数据集、特征空间和模型参数. 我们的攻击目标是在修改恶意应用程序的函数调用图以逃避目标系统的检测. .两种基于 FCG 的 AMD，即 Malscan (ASE 2019)和 Mamadroid (NDSS 2017)，以及一种 Android Malware Detection 增强方法，即 APIGraph，用于评估我们攻击的有效性.</p>
<p>上述两种检测模型拥有很高的检测性能：98% detection accuracy for Malscan and 99% F1 score for Mamadroid.</p>
<h3 id="攻击方法的形式化"><a class="markdownIt-Anchor" href="#攻击方法的形式化"></a> 攻击方法的形式化</h3>
<p>攻击方法<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">K</mi></mrow><annotation encoding="application/x-tex">\mathcal{K}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.68333em;vertical-align:0em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.01445em;">K</span></span></span></span></span>的输入是一个FCG（邻接矩阵），该方法会通过在邻接矩阵上加一个扰动矩阵δ的方式修改这个图：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>G</mi><mo>~</mo></mover><mo>=</mo><mi mathvariant="script">K</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">)</mo><mo>=</mo><mi>G</mi><mo>+</mo><mi>δ</mi></mrow><annotation encoding="application/x-tex">\tilde{G}=\mathcal{K}(G)=G+\delta
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9201899999999998em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">G</span></span></span><span style="top:-3.6023300000000003em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">~</span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal" style="margin-right:0.01445em;">K</span></span><span class="mopen">(</span><span class="mord mathdefault">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:0.76666em;vertical-align:-0.08333em;"></span><span class="mord mathdefault">G</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span></span><span class="base"><span class="strut" style="height:0.69444em;vertical-align:0em;"></span><span class="mord mathdefault" style="margin-right:0.03785em;">δ</span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mover accent="true"><mi>G</mi><mo>~</mo></mover></mrow><annotation encoding="application/x-tex">\tilde{G}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.9201899999999998em;vertical-align:0em;"></span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">G</span></span></span><span style="top:-3.6023300000000003em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">~</span></span></span></span></span></span></span></span></span>就是对抗样本图. 使用<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>G</mi><mo separator="true">,</mo><mi>θ</mi><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(G,\theta)</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">G</span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord mathdefault" style="margin-right:0.02778em;">θ</span><span class="mclose">)</span></span></span></span>表示恶意软件检测模型在模型参数θ下的检测结果，攻击目标是让模型将恶意样本错误分类为良性，形式化为：<span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi>f</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">)</mo><mi mathvariant="normal">≠</mi><mi>f</mi><mo stretchy="false">(</mo><mover accent="true"><mi>G</mi><mo>~</mo></mover><mo stretchy="false">)</mo></mrow><annotation encoding="application/x-tex">f(G) \ne f(\tilde{G})</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">G</span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.1701899999999998em;vertical-align:-0.25em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9201899999999998em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">G</span></span></span><span style="top:-3.6023300000000003em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">~</span></span></span></span></span></span><span class="mclose">)</span></span></span></span></p>
<p>在与原来的功能相同的情况下，我们设计了四种类型的修改动作，即添加边、重写、插入节点和删除节点，这也是考虑到了Apps的特点. 接下来，我们首先介绍了约束条件的定义，然后描述每个动作的定义和属性.</p>
<p>上文已经提到过四种修改了，这里对<strong>重写</strong>，删除这两种修改动作做个解释.</p>
<p>本文定义了Constraints，它列出了APP中methods的可修改性. 当HRAT修改FCGs中的节点和边时，需要遵循这个约束条件. HRAT只能修改modifiable methods和call relations. 我们通过Android，Flowdroid和soot的性质决定了以下不可行修改的约束：</p>
<ul>
<li>Framework APIs：framework API是在Android系统而不是应用程序中定义和实现的，因此它们是不可修改的.</li>
<li>Lifecycle methods：生命周期方法有Android系统调用，如果我们删除或增加这样的函数调用则容易使APP崩溃.</li>
<li>Flowdroid methods：因为Flowdroid引入了额外的methods便于分析APPs，FCGs也会包含这些方法.</li>
</ul>
<p>说回<strong>重写</strong>这个修改动作：</p>
<p>将三个不在约束条件中的node： <span class="katex"><span class="katex-mathml"><math><semantics><mrow><msub><mi>A</mi><mi>r</mi></msub><mo>=</mo><mo stretchy="false">{</mo><msub><mi>v</mi><mrow><mi>b</mi><mi>e</mi><mi>g</mi></mrow></msub><mo separator="true">,</mo><msub><mi>v</mi><mrow><mi>e</mi><mi>n</mi><mi>d</mi></mrow></msub><mo separator="true">,</mo><msub><mi>v</mi><mrow><mi>m</mi><mi>i</mi><mi>d</mi></mrow></msub><mo stretchy="false">}</mo></mrow><annotation encoding="application/x-tex">A_r = \{v_{beg},v_{end},v_{mid}\}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.83333em;vertical-align:-0.15em;"></span><span class="mord"><span class="mord mathdefault">A</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mathdefault mtight" style="margin-right:0.02778em;">r</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:1.036108em;vertical-align:-0.286108em;"></span><span class="mopen">{</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">b</span><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">e</span><span class="mord mathdefault mtight">n</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.03588em;">v</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.03588em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">m</span><span class="mord mathdefault mtight">i</span><span class="mord mathdefault mtight">d</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose">}</span></span></span></span> 将开始节点和结束节点之间的边删除，增加从开始节点到中间节点的边，增加从中间节点到结束节点之间的边.</p>
<p>另外，删除动作：</p>
<p>删除一个不在约束中的节点并连接被删除节点的caller和callee.</p>
<h3 id="启发式优化基于结构攻击的强化学习"><a class="markdownIt-Anchor" href="#启发式优化基于结构攻击的强化学习"></a> 启发式优化基于结构攻击的强化学习</h3>
<p>结构化攻击过程有一系列针对图的攻击动作组成. 具体来说，每次攻击动作由两个阶段：决定一个攻击类型和选择一个攻击对象. 前者决定动作类型的问题（adding edge, rewriting, inserting/deleting node），后者决定那条边或者节点要被修改.</p>
<p>我们的优化目标是得到尽可能小的图上的修改序列，而不是某种隐藏的结构，所以这里选择交互式的学习算法—强化学习模型. 这里的隐藏结构就是说，该目标不是传统的在数据集上找某种隐藏的扰动结构可以使得模型出错，而是生成一个某种约束下的改动序列.</p>
<h3 id="state-space"><a class="markdownIt-Anchor" href="#state-space"></a> state space</h3>
<p>状态空间存储所有攻击过程中出现的中间状态. HRAT选择从中间图上抽取出的特征向量进行存储. 例如，当HRAT攻击Malscan模型时，状态空间存储所有过程中产生的centrality features of sensitive APIs. 特征向量的长度固定，适合训练策略网络. 我们不使用邻接矩阵，因为如何动态地处理图形尺度的变化超出了本文的范围.</p>
<p>此外，HRAT只存储上一次修改后的图（邻接矩阵的形式），这有利于下一次在图上的修改. 我们每次修改只基于当前的图和状态，存储历史图结构是浪费内存.</p>
<h3 id="policy-model"><a class="markdownIt-Anchor" href="#policy-model"></a> Policy Model</h3>
<p>策略模型确定攻击行为，包括决定行为类型和选择攻击目标. HRAT基于强化学习，具体来说是deep Q-learning来确定攻击行为.</p>
<p>文中对deep Q-learning用于structural attack的算法有详细描述，这里就不展开，我们避免陷入过于细节的地方而失去了对文章整体的把握.</p>
<h3 id="action-space"><a class="markdownIt-Anchor" href="#action-space"></a> Action Space</h3>
<p>action space存储了修改图的操作，每个操作表示为一个四元组：{动作类型，对象*3}.</p>
<h3 id="reward-function"><a class="markdownIt-Anchor" href="#reward-function"></a> Reward Function</h3>
<ol>
<li>反馈函数评估所选的动作的在当前状态上的效果.</li>
</ol>
<p>因为目标是让通过尽可能小的修改使得系统分类出错，所以反馈函数定义为：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="script">R</mi><mrow><mo fence="true">(</mo><msub><mi>s</mi><mi>t</mi></msub><mo separator="true">,</mo><msub><mi>a</mi><mi>t</mi></msub><mo fence="true">)</mo></mrow><mo>=</mo><mrow><mo fence="true">{</mo><mtable rowspacing="0.3599999999999999em" columnalign="left left" columnspacing="1em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mn>1</mn></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>f</mi><mo stretchy="false">(</mo><mover accent="true"><mi>G</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mi mathvariant="normal">≠</mi><mi>f</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mo>−</mo><mrow><mo fence="true">(</mo><mi mathvariant="normal">Δ</mi><msub><mi>N</mi><mtext>node </mtext></msub><mo>+</mo><mi mathvariant="normal">Δ</mi><msub><mi>N</mi><mtext>edge </mtext></msub><mo fence="true">)</mo></mrow></mrow></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="false"><mrow><mtext> if </mtext><mi>f</mi><mo stretchy="false">(</mo><mover accent="true"><mi>G</mi><mo>^</mo></mover><mo stretchy="false">)</mo><mo>=</mo><mi>f</mi><mo stretchy="false">(</mo><mi>G</mi><mo stretchy="false">)</mo></mrow></mstyle></mtd></mtr></mtable></mrow></mrow><annotation encoding="application/x-tex">\mathcal{R}\left(s_{t}, a_{t}\right)= \begin{cases}1 &amp; \text { if } f(\hat{G}) \neq f(G) \\ -\left(\Delta N_{\text {node }}+\Delta N_{\text {edge }}\right) &amp; \text { if } f(\hat{G})=f(G)\end{cases}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:1em;vertical-align:-0.25em;"></span><span class="mord"><span class="mord mathcal">R</span></span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord"><span class="mord mathdefault">s</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord"><span class="mord mathdefault">a</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.2805559999999999em;"><span style="top:-2.5500000000000003em;margin-left:0em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">t</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span></span><span class="base"><span class="strut" style="height:3.0000299999999998em;vertical-align:-1.25003em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;"><span class="delimsizing size4">{</span></span><span class="mord"><span class="mtable"><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">1</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord">−</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="minner"><span class="mopen delimcenter" style="top:0em;">(</span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">node </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mbin">+</span><span class="mspace" style="margin-right:0.2222222222222222em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">edge </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mclose delimcenter" style="top:0em;">)</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span><span class="arraycolsep" style="width:1em;"></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:1.69em;"><span style="top:-3.69em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">G</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel"><span class="mrel"><span class="mord"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.69444em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="rlap"><span class="strut" style="height:0.8888799999999999em;vertical-align:-0.19444em;"></span><span class="inner"><span class="mrel"></span></span><span class="fix"></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.19444em;"><span></span></span></span></span></span></span><span class="mrel">=</span></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">G</span><span class="mclose">)</span></span></span><span style="top:-2.25em;"><span class="pstrut" style="height:3.008em;"></span><span class="mord"><span class="mord text"><span class="mord"> if </span></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord accent"><span class="vlist-t"><span class="vlist-r"><span class="vlist" style="height:0.9467699999999999em;"><span style="top:-3em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord mathdefault">G</span></span></span><span style="top:-3.25233em;"><span class="pstrut" style="height:3em;"></span><span class="accent-body" style="left:-0.16666em;">^</span></span></span></span></span></span><span class="mclose">)</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord mathdefault" style="margin-right:0.10764em;">f</span><span class="mopen">(</span><span class="mord mathdefault">G</span><span class="mclose">)</span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:1.19em;"><span></span></span></span></span></span></span></span><span class="mclose nulldelimiter"></span></span></span></span></span></span></p>
<p><span class="katex"><span class="katex-mathml"><math><semantics><mrow><mi mathvariant="normal">Δ</mi><msub><mi>N</mi><mtext>node </mtext></msub><mo separator="true">,</mo><mi mathvariant="normal">Δ</mi><msub><mi>N</mi><mtext>edge </mtext></msub></mrow><annotation encoding="application/x-tex">\Delta N_{\text {node }},\Delta N_{\text {edge }}</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:0.969438em;vertical-align:-0.286108em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.33610799999999996em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">node </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mpunct">,</span><span class="mspace" style="margin-right:0.16666666666666666em;"></span><span class="mord">Δ</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.3361079999999999em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord text mtight"><span class="mord mtight">edge </span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span>代表当前修改后的graph和原始的graph中间在node数量和edge数量上的差别.</p>
<ol>
<li>反馈函数评估所选的攻击动作类型和攻击对象</li>
</ol>
<ul>
<li>adding edge的反馈是-1，因为无论梯度搜索选择了哪一个边，只有一个边被修改了.</li>
<li>rewriting 和inserting node的反馈是-3和-2.</li>
<li>removing node删除一个节点并连接被删除节点的caller和callee，其反馈是：1+该节点caller的数量*该节点callee的数量.</li>
</ul>
<h3 id="结构化攻击的优点和有效性"><a class="markdownIt-Anchor" href="#结构化攻击的优点和有效性"></a> 结构化攻击的优点和有效性</h3>
<blockquote>
<p>Structural attacks bridge the gap between feature-space attacks, which only perturb feature vectors to deceive the classifier, and problem-space attacks, which generate adversarial objects.</p>
</blockquote>
<p>也就是[1]中提到的inverse feature-mapping problem. 现存的问题空间的攻击受限于inverse feature-mapping problem(即，优化feature-space attacks 不能被很好的映射到problem-space attacks) 我们的Structural attacks基于App的FCG修改nodes and edges，因此，四个FCG修改动作对应了App上的修改.</p>
<p>暗涵，我们的攻击也涉及到了向量空间，毕竟还是将向量送给目标模型，而且我们也在problem space上找到了对应修改，所以我们就能说我们弥补了feature-space attacks和problem-space attacks之间的鸿沟.</p>
<h2 id="android-application-manipulation"><a class="markdownIt-Anchor" href="#android-application-manipulation"></a> Android Application Manipulation</h2>
<p>阐述本文开发的基于graph modification自动生成App Manipulation的工具（APPMOD）. 遵循以下两个原则：</p>
<ul>
<li>a) Functional Consistency：APP的功能在修改前后保持一致</li>
<li>b) Valid Modifications：插入的代码不会被静态分析移除. 具体来说静态分析会删除永远不会执行的dead code.</li>
</ul>
<p>HRAT的原型（即APPMOD）构建在soot上. APPMOD使用soot修改Apps，soot将会在无源码的情况下翻译android字节码到中间表示. 根据方法签名APPMOD将会定位到App中的方法并进行修改.</p>
<p>方法签名示例：<code>&lt;packageName.className returnType methodName(paraList)&gt;</code></p>
<p>APPMOD的工作流如下图所示.</p>
<p><img src="/images/HRAT2.png" alt="HRAT2" / srcset="/images/LoadingImage.gif" data-src="/images/HRAT2.png" class="lozad post-image"></p>
<p>原文中也对App修改的具体方法进行了详细介绍Sec4.2-4.5，这里也不展开了.</p>
<h2 id="结果评估"><a class="markdownIt-Anchor" href="#结果评估"></a> 结果评估</h2>
<p><img src="/images/HRAT3.png" alt="HRAT3" / srcset="/images/LoadingImage.gif" data-src="/images/HRAT3.png" class="lozad post-image"></p>
<p>本文主要工作，HRAT的完整工作流如上图所示.</p>
<p>① 抽取FCG</p>
<p>② 生成一个graph modification sequence（GMS）这个序列中每一项都表示一个对node或edge的扰动</p>
<p>③ 将GMS转换到实际App上的Manipulation</p>
<p>④ App依照GMS进行逐项修改</p>
<p>⑤ 最后我们评估生产的重打包的App是否能避免被目标系统检测出来</p>
<p>⑥ 下面通过回答以下五个问题评估HRAT的表现</p>
<ul>
<li>RQ1: Effectiveness analysis. How effective is HRAT against the state-of-the-art AMD techniques?</li>
<li>RQ2: Modification efficiency comparisons. Compared with other attack methods, how is the modification efficiency of HRAT?</li>
<li>RQ3: Effectiveness of IMA. How effective is individual modification action (IMA)?</li>
<li>RQ4: Resilience to code obfuscation. How is the resilience of HRAT to malware with different obfuscation techniques?</li>
<li>RQ5: Functional consistency assessment. Do the adversarial app generated by HRAT preserve the functionality as the original one?</li>
</ul>
<h3 id="dataset"><a class="markdownIt-Anchor" href="#dataset"></a> Dataset</h3>
<p>使用11,613 benign Apps and 11,583 malicious Apps from 2011 to 2018 in Malscan 评估HRAT（for RQ1-3&amp;5）. 所有App都来自AndroidZoo，并且每个样本都经过多个反病毒引擎测试才决定了其标签. 对于RQ4&amp;5，我们使用了一个先前工作中构建的数据集，来评估HRAT的有效性. 这个数据集包含不同家族的恶意软件，其中6586个经过变量重命名混淆，1090个通过字符串加密混淆，1172包含反射.</p>
<h3 id="metrics"><a class="markdownIt-Anchor" href="#metrics"></a> Metrics</h3>
<p>为了评估feature-space 和 problem-space的攻击的有效性，本文设计了三种attack success rates（ASRs）：</p>
<p class='katex-block'><span class="katex-display"><span class="katex"><span class="katex-mathml"><math><semantics><mtable rowspacing="0.24999999999999992em" columnalign="right left" columnspacing="0em"><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext> Init_ASR </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>N</mi><mi>g</mi></msub><mi mathvariant="normal">/</mi><mi>N</mi></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext> Rela_ASR </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>N</mi><mi>p</mi></msub><mi mathvariant="normal">/</mi><msub><mi>N</mi><mi>g</mi></msub></mrow></mstyle></mtd></mtr><mtr><mtd><mstyle scriptlevel="0" displaystyle="true"><mtext> Abs_ASR </mtext></mstyle></mtd><mtd><mstyle scriptlevel="0" displaystyle="true"><mrow><mrow></mrow><mo>=</mo><msub><mi>N</mi><mi>s</mi></msub><mi mathvariant="normal">/</mi><msub><mi>N</mi><mi>p</mi></msub></mrow></mstyle></mtd></mtr></mtable><annotation encoding="application/x-tex">\begin{aligned}\text { Init\_ASR } &amp;=N_{g} / N \\\text { Rela\_ASR } &amp;=N_{p} / N_{g} \\\text { Abs\_ASR } &amp;=N_{s} / N_{p}\end{aligned}
</annotation></semantics></math></span><span class="katex-html" aria-hidden="true"><span class="base"><span class="strut" style="height:4.500000000000002em;vertical-align:-2.000000000000001em;"></span><span class="mord"><span class="mtable"><span class="col-align-r"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord"> Init_ASR </span></span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord"> Rela_ASR </span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord text"><span class="mord"> Abs_ASR </span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span><span class="col-align-l"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:2.5000000000000004em;"><span style="top:-4.66em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord mathdefault" style="margin-right:0.10903em;">N</span></span></span><span style="top:-3.16em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight" style="margin-right:0.03588em;">g</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span><span style="top:-1.6599999999999993em;"><span class="pstrut" style="height:3em;"></span><span class="mord"><span class="mord"></span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mrel">=</span><span class="mspace" style="margin-right:0.2777777777777778em;"></span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.151392em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">s</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.15em;"><span></span></span></span></span></span></span><span class="mord">/</span><span class="mord"><span class="mord mathdefault" style="margin-right:0.10903em;">N</span><span class="msupsub"><span class="vlist-t vlist-t2"><span class="vlist-r"><span class="vlist" style="height:0.15139200000000003em;"><span style="top:-2.5500000000000003em;margin-left:-0.10903em;margin-right:0.05em;"><span class="pstrut" style="height:2.7em;"></span><span class="sizing reset-size6 size3 mtight"><span class="mord mtight"><span class="mord mathdefault mtight">p</span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:0.286108em;"><span></span></span></span></span></span></span></span></span></span><span class="vlist-s">​</span></span><span class="vlist-r"><span class="vlist" style="height:2.000000000000001em;"><span></span></span></span></span></span></span></span></span></span></span></span></p>
<ul>
<li>Initialization ASR：N是恶意样本总数，Ng是改变了FCG并成功避免系统识别的样本数量，且一个样本最多500个修改，这里的门限值回答了RQ2，我们发现几乎100%的样本在500次以内的修改就可以逃避检测. 需要注意，由于anti-repackage protection的存在，并不是所有FCGs上的修改都可以被重打包. （<strong>这其实可以看作feature-space attack</strong>）</li>
<li>Relative ASR：反应了成功重打包的比例. Np为，在Ng中成功重打包的比例. （也就是feature-space attack能inverse mapping 到problem-space的比例）</li>
<li>Absolute ASR：反映了HRAT在problem space上的有效性，即是否重打包的样本可以逃避检测并且保持功能性. Ns是Np中成功避免检测的样本数量. （就是problem-space attack成功率）</li>
</ul>
<h3 id="实验结果"><a class="markdownIt-Anchor" href="#实验结果"></a> 实验结果</h3>
<p>本文设计了以下三个数据集做HRAT的有效性分析：</p>
<ul>
<li>第一个数据集中，训练集(TRo) 和测试集(TEo)是在同一时间段被收集的.</li>
<li>第二个数据集中，测试集(TE1 and TE2)是在训练集之后被收集的. 这个数据集模拟了使用已知样本训练检测器并使用它检测未知恶意样本的实际使用情形.</li>
<li>第三个数据集使用最新的恶意软件(TR2)训练分类器使用旧的恶意软件(TE1)做测试.</li>
</ul>
<p>结果如下图所示：</p>
<p><img src="/images/HRAT4.png" alt="HRAT4" / srcset="/images/LoadingImage.gif" data-src="/images/HRAT4.png" class="lozad post-image"></p>
<p>使用不同算法的攻击成功率如下图所示（using TRo for training and TE1 for testing）：</p>
<p><img src="/images/HRAT5.png" alt="HRAT5" / srcset="/images/LoadingImage.gif" data-src="/images/HRAT5.png" class="lozad post-image"></p>
<p>使用SACK，HACK和EPACK的Init_ASR比强化学习低，因为evolutionary algorithms 把结构攻击引导向，随机地选择攻击行为. 受益于结构攻击，基于演化的算法实现了和强化学习相同的Abs ASR.</p>
<p>关于这几种算法可以查看原文附录，<strong>SACK</strong>: simulated annealing based structural attack，<strong>HACK</strong>: hill-climbing based structural attack，<strong>EPACK</strong>: evolutionary programming based structural attack.</p>
<p>总结：</p>
<blockquote>
<p>Answer to RQ1: HRAT实现了在500次修改内高达99.94%的攻击成功率. 如果不做严格的修改次数限制HRAT可以达到100%的problem-space attack成功率.</p>
</blockquote>
<p>再来看一下HRAT的修改效率：</p>
<p><img src="/images/HRAT6.png" alt="HRAT6" / srcset="/images/LoadingImage.gif" data-src="/images/HRAT6.png" class="lozad post-image"></p>
<p>CDF：cumulative distribution of the required number of modifications for evasion 就是需要修改的最少次数能避免被检测的样本累计统计.</p>
<p>看图可知HRAT是几种算法中效率最好的，因为多数样本在100次修改就可以完成欺骗.</p>
<blockquote>
<p>Answer to RQ2: HRAT需要的骗过检测器的App修改次数少于其他算法.</p>
</blockquote>
<p>文章对其他几个进行了一一解答，这里我们已经看到这篇文章的创新点和实验效果，就不在展开更多实验内容了.</p>
<h2 id="对我有什么启发总结"><a class="markdownIt-Anchor" href="#对我有什么启发总结"></a> 对我有什么启发（总结）</h2>
<p>[1]才是这个任务的上游玩家，这篇就文章有点…</p>
<p>不过本文也是做了不少实验，能把强化学习应用到inverse feature-space mapping这个问题上算是比较有趣的工作，但是文章读下来感觉不够简洁，没能把细节清晰明了的展现给读者，当然也可能是我能力不够XD.</p>
<p>另外，这篇文章的作者（们）还写过一篇<strong>BinarizedAttack: Structural Poisoning Attacks to Graph-based Anomaly Detection</strong>[2]，发表在ICDE 2022数据库顶会，这篇文章是对基于图的异常检测模型进行结构化投毒攻击，主要讲对图结构进行修改达到让模型分类出错的问题，给我的感觉作者应该是先做了BinarizedAttack这篇文章，然后才是本文. 然而，本文发表于CCS 2021，至于前者是否是二投我也没问作者，这不太重要. <strong>总而言之，这两篇文章都是对图模型的攻击，虽然关注点不太一样，但不失为很好的参考对象.</strong></p>
<hr />
<p>论文链接：<a target="_blank" rel="noopener" href="https://dl.acm.org/doi/abs/10.1145/3460120.3485387">Structural Attack against Graph Based Android Malware Detection | Proceedings of the 2021 ACM SIGSAC Conference on Computer and Communications Security</a></p>
<p>参考文章：</p>
<ul>
<li>[1] <a target="_blank" rel="noopener" href="https://arxiv.org/abs/1911.02142">[1911.02142] Intriguing Properties of Adversarial ML Attacks in the Problem Space (arxiv.org)</a></li>
<li>[2] <a target="_blank" rel="noopener" href="https://arxiv.org/abs/2106.09989">[2106.09989] BinarizedAttack: Structural Poisoning Attacks to Graph-based Anomaly Detection (arxiv.org)</a></li>
<li>作者主页 <a target="_blank" rel="noopener" href="https://www4.comp.polyu.edu.hk/~csxluo/">Daniel Xiapu Luo’s homepage (polyu.edu.hk)</a></li>
</ul>

  </div>
  <div>
    
      <div 
        class="post-note note-info copyright" 
        style="margin-top: 42px">
        <p>
          <span style="font-weight: bold;">作者：</span><a 
            target="_blank" 
            rel="nofollow noopener noreferrer" 
            href="/about">
            Ch3nYe
          </a>
        </p>
        <p>
          <span style="font-weight: bold;">文章链接：</span><a 
            target="_blank" 
            rel="nofollow noopener noreferrer" 
            href="https://ch3nye.top/Note-Structural-Attack-against-Graph-Based-Android-Malware-Detection/">
            https://ch3nye.top/Note-Structural-Attack-against-Graph-Based-Android-Malware-Detection/
          </a>
        </p>
        <p><span style="font-weight: bold;">版权声明：</span>本博客所有文章除特别声明外，均采用<a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-nc-sa/4.0/deed.zh">CC BY-NC-SA 4.0 协议</a>。转载请注明出处！</p>
      </div>
    
  </div>
</article>
<div class="nav">
  
    <div class="nav-item-prev">
      <a 
        href="/Note-Nero/" 
        class="nav-link">
        <i class="iconfont icon-left nav-prev-icon"></i>
        <div>
          <div class="nav-label">上一篇</div>
          
            <div class="nav-title">Note 《Neural reverse engineering of stripped binaries using augmented control flow graphs》 </div>
          
        </div>
      </a>
    </div>
  
  
    <div class="nav-item-next">
      <a 
        href="/Note-ELECTRA-Pre-training-Text-Encoders-as-Discriminators-Rather-Than-Generators/" 
        class="nav-link">
        <div>
          <div class="nav-label">下一篇</div>
          
            <div class="nav-title">Note 《ELECTRA Pre-training Text Encoders as Discriminators Rather Than Generators》 </div>
          
        </div>
        <i class="iconfont icon-right nav-next-icon"></i>
      </a>
    </div>
  
</div>

  <div 
    class="card card-content comment-card" 
    style="margin-top: 16px;">
    <div class="comment-card-title">评论</div>
    
  <div id="gitalk-container"></div>
  
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css">

  
<script src="//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js"></script>

  
<script src="/js/lib/md5.min.js"></script>

  <script>
    var gitalk = new Gitalk({
      clientID: '049b30eb10ea05082ef1',
      clientSecret: 'c33ad95041c69907b3136b895008320f000987db',
      repo: 'Ch3nYe.github.io',
      owner: 'Ch3nYe',
      admin: "Ch3nYe",
      id: md5(location.href),
      distractionFreeMode: false,
      language: 'navigator.language || navigator.userLanguage',
      labels: ["Gitalk"],
      perPage: 10
    })

    gitalk.render('gitalk-container')
  </script>

  </div>

<div 
  class="card card-content toc-card" 
  id="mobiletoc">
  <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>目录
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#structural-attack-against-graph-based-android-malware-detection"><span class="toc-text"> Structural Attack against Graph Based Android Malware Detection</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E8%A7%A3%E5%86%B3%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98"><span class="toc-text"> 主要解决什么问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87%E7%B3%BB%E7%BB%9F"><span class="toc-text"> 目标系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#malscan"><span class="toc-text"> Malscan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mamadroid"><span class="toc-text"> Mamadroid</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#apigraph"><span class="toc-text"> APIGraph</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95"><span class="toc-text"> 攻击方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A8%81%E8%83%81%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 威胁模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95%E7%9A%84%E5%BD%A2%E5%BC%8F%E5%8C%96"><span class="toc-text"> 攻击方法的形式化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8F%91%E5%BC%8F%E4%BC%98%E5%8C%96%E5%9F%BA%E4%BA%8E%E7%BB%93%E6%9E%84%E6%94%BB%E5%87%BB%E7%9A%84%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0"><span class="toc-text"> 启发式优化基于结构攻击的强化学习</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#state-space"><span class="toc-text"> state space</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#policy-model"><span class="toc-text"> Policy Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#action-space"><span class="toc-text"> Action Space</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reward-function"><span class="toc-text"> Reward Function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E5%8C%96%E6%94%BB%E5%87%BB%E7%9A%84%E4%BC%98%E7%82%B9%E5%92%8C%E6%9C%89%E6%95%88%E6%80%A7"><span class="toc-text"> 结构化攻击的优点和有效性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#android-application-manipulation"><span class="toc-text"> Android Application Manipulation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E8%AF%84%E4%BC%B0"><span class="toc-text"> 结果评估</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dataset"><span class="toc-text"> Dataset</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#metrics"><span class="toc-text"> Metrics</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="toc-text"> 实验结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E6%88%91%E6%9C%89%E4%BB%80%E4%B9%88%E5%90%AF%E5%8F%91%E6%80%BB%E7%BB%93"><span class="toc-text"> 对我有什么启发（总结）</span></a></li></ol></li></ol>
</div></main>
            <aside class="left-column">
              
              <div class="card card-author">
                
  <img 
    src="/images/logo.png" 
    class="author-img"
    width="88"
    height="88"
    alt="author avatar">

<p class="author-name">Ch3nYe</p>
<p class="author-description">如果有文章有任何错误请留言，谢谢🙏</p>
<div class="author-message">
  <a 
    class="author-posts-count" 
    href="/archives">
    <span>43</span>
    <span>文章</span>
  </a>
  <a 
    class="author-categories-count" 
    href="/categories">
    <span>7</span>
    <span>分类</span>
  </a>
  <a 
    class="author-tags-count" 
    href="/tags">
    <span>65</span>
    <span>标签</span>
  </a>
</div>

  <div class="author-card-society">
    
      <div class="author-card-society-icon">
        <a target="_blank" rel="noopener" href="https://github.com/ch3nye/">
          <i class="iconfont icon-github society-icon"></i>
        </a>
      </div>
    
      <div class="author-card-society-icon">
        <a href="mailto:sud0su@163.com">
          <i class="iconfont icon-mail society-icon"></i>
        </a>
      </div>
    
  </div>

              </div>
               <div class="sticky-tablet">
  
  
    <article class="display-when-two-columns spacer">
      <div class="card card-content toc-card">
        <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>目录
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#structural-attack-against-graph-based-android-malware-detection"><span class="toc-text"> Structural Attack against Graph Based Android Malware Detection</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E8%A7%A3%E5%86%B3%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98"><span class="toc-text"> 主要解决什么问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87%E7%B3%BB%E7%BB%9F"><span class="toc-text"> 目标系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#malscan"><span class="toc-text"> Malscan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mamadroid"><span class="toc-text"> Mamadroid</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#apigraph"><span class="toc-text"> APIGraph</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95"><span class="toc-text"> 攻击方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A8%81%E8%83%81%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 威胁模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95%E7%9A%84%E5%BD%A2%E5%BC%8F%E5%8C%96"><span class="toc-text"> 攻击方法的形式化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8F%91%E5%BC%8F%E4%BC%98%E5%8C%96%E5%9F%BA%E4%BA%8E%E7%BB%93%E6%9E%84%E6%94%BB%E5%87%BB%E7%9A%84%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0"><span class="toc-text"> 启发式优化基于结构攻击的强化学习</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#state-space"><span class="toc-text"> state space</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#policy-model"><span class="toc-text"> Policy Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#action-space"><span class="toc-text"> Action Space</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reward-function"><span class="toc-text"> Reward Function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E5%8C%96%E6%94%BB%E5%87%BB%E7%9A%84%E4%BC%98%E7%82%B9%E5%92%8C%E6%9C%89%E6%95%88%E6%80%A7"><span class="toc-text"> 结构化攻击的优点和有效性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#android-application-manipulation"><span class="toc-text"> Android Application Manipulation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E8%AF%84%E4%BC%B0"><span class="toc-text"> 结果评估</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dataset"><span class="toc-text"> Dataset</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#metrics"><span class="toc-text"> Metrics</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="toc-text"> 实验结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E6%88%91%E6%9C%89%E4%BB%80%E4%B9%88%E5%90%AF%E5%8F%91%E6%80%BB%E7%BB%93"><span class="toc-text"> 对我有什么启发（总结）</span></a></li></ol></li></ol>
      </div>
    </article>
  
  
  <article class="card card-content categories-widget">
    <div class="categories-card">
  <div class="categories-header">
    <i 
      class="iconfont icon-fenlei" 
      style="padding-right: 2px;">
    </i>分类
  </div>
  <div class="categories-list">
    
      <a href="/categories/%E7%94%9F%E6%B4%BB/">
        <div class="categories-list-item">
          生活
          <span class="categories-list-item-badge">2</span>
        </div>
      </a>
    
      <a href="/categories/%E5%A4%87%E5%BF%98/">
        <div class="categories-list-item">
          备忘
          <span class="categories-list-item-badge">2</span>
        </div>
      </a>
    
      <a href="/categories/%E6%9D%8E%E5%AE%8F%E6%AF%85%E6%9C%BA%E5%99%A8%E5%AD%A6%E4%B9%A0%E7%AC%94%E8%AE%B0/">
        <div class="categories-list-item">
          李宏毅机器学习笔记
          <span class="categories-list-item-badge">15</span>
        </div>
      </a>
    
      <a href="/categories/%E8%AE%BA%E6%96%87%E9%98%85%E8%AF%BB/">
        <div class="categories-list-item">
          论文阅读
          <span class="categories-list-item-badge">12</span>
        </div>
      </a>
    
      <a href="/categories/%E5%AE%9E%E6%88%98/">
        <div class="categories-list-item">
          实战
          <span class="categories-list-item-badge">3</span>
        </div>
      </a>
    
      <a href="/categories/%E7%AC%94%E8%AE%B0/">
        <div class="categories-list-item">
          笔记
          <span class="categories-list-item-badge">6</span>
        </div>
      </a>
    
      <a href="/categories/%E7%BF%BB%E8%AF%91/">
        <div class="categories-list-item">
          翻译
          <span class="categories-list-item-badge">3</span>
        </div>
      </a>
    
  </div>
</div>
  </article>
  
  <article class="card card-content tags-widget">
    <div class="tags-card">
  <div class="tags-header">
    <i 
      class="iconfont icon-biaoqian" 
      style="padding-right: 2px;">
    </i>热门标签
  </div>
  <div class="tags-list">
    
      <a 
        href="/tags/note/" 
        title="note">
        <div class="tags-list-item">note</div>
      </a>
    
      <a 
        href="/tags/ML/" 
        title="ML">
        <div class="tags-list-item">ML</div>
      </a>
    
      <a 
        href="/tags/Next-Step-of-ML/" 
        title="Next-Step-of-ML">
        <div class="tags-list-item">Next-Step-of-ML</div>
      </a>
    
      <a 
        href="/tags/%E7%AC%94%E8%AE%B0/" 
        title="笔记">
        <div class="tags-list-item">笔记</div>
      </a>
    
      <a 
        href="/tags/%E8%AE%BA%E6%96%87/" 
        title="论文">
        <div class="tags-list-item">论文</div>
      </a>
    
      <a 
        href="/tags/Android/" 
        title="Android">
        <div class="tags-list-item">Android</div>
      </a>
    
      <a 
        href="/tags/%E6%80%BB%E7%BB%93/" 
        title="总结">
        <div class="tags-list-item">总结</div>
      </a>
    
      <a 
        href="/tags/Binary/" 
        title="Binary">
        <div class="tags-list-item">Binary</div>
      </a>
    
      <a 
        href="/tags/Deep-Learning/" 
        title="Deep-Learning">
        <div class="tags-list-item">Deep-Learning</div>
      </a>
    
      <a 
        href="/tags/%E7%BF%BB%E8%AF%91/" 
        title="翻译">
        <div class="tags-list-item">翻译</div>
      </a>
    
      <a 
        href="/tags/%E5%AD%A6%E4%B9%A0/" 
        title="学习">
        <div class="tags-list-item">学习</div>
      </a>
    
      <a 
        href="/tags/%E5%AE%9E%E6%88%98/" 
        title="实战">
        <div class="tags-list-item">实战</div>
      </a>
    
      <a 
        href="/tags/crack/" 
        title="crack">
        <div class="tags-list-item">crack</div>
      </a>
    
      <a 
        href="/tags/%E4%BA%8C%E8%BF%9B%E5%88%B6/" 
        title="二进制">
        <div class="tags-list-item">二进制</div>
      </a>
    
      <a 
        href="/tags/Rust/" 
        title="Rust">
        <div class="tags-list-item">Rust</div>
      </a>
    
      <a 
        href="/tags/HTTPS/" 
        title="HTTPS">
        <div class="tags-list-item">HTTPS</div>
      </a>
    
  </div>
</div>
  </article>
  
  
</div>
            </aside>
            <aside class="right-column">
              <div class="sticky-widescreen">
  
  
    <article class="card card-content toc-card">
      <div class="toc-header">
  <i 
    class="iconfont icon-menu" 
    style="padding-right: 2px;">
  </i>目录
</div>
<ol class="toc"><li class="toc-item toc-level-1"><a class="toc-link" href="#structural-attack-against-graph-based-android-malware-detection"><span class="toc-text"> Structural Attack against Graph Based Android Malware Detection</span></a><ol class="toc-child"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E4%B8%BB%E8%A6%81%E8%A7%A3%E5%86%B3%E4%BB%80%E4%B9%88%E9%97%AE%E9%A2%98"><span class="toc-text"> 主要解决什么问题</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%9B%AE%E6%A0%87%E7%B3%BB%E7%BB%9F"><span class="toc-text"> 目标系统</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#malscan"><span class="toc-text"> Malscan</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#mamadroid"><span class="toc-text"> Mamadroid</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#apigraph"><span class="toc-text"> APIGraph</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95"><span class="toc-text"> 攻击方法</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A8%81%E8%83%81%E6%A8%A1%E5%9E%8B"><span class="toc-text"> 威胁模型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%94%BB%E5%87%BB%E6%96%B9%E6%B3%95%E7%9A%84%E5%BD%A2%E5%BC%8F%E5%8C%96"><span class="toc-text"> 攻击方法的形式化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%90%AF%E5%8F%91%E5%BC%8F%E4%BC%98%E5%8C%96%E5%9F%BA%E4%BA%8E%E7%BB%93%E6%9E%84%E6%94%BB%E5%87%BB%E7%9A%84%E5%BC%BA%E5%8C%96%E5%AD%A6%E4%B9%A0"><span class="toc-text"> 启发式优化基于结构攻击的强化学习</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#state-space"><span class="toc-text"> state space</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#policy-model"><span class="toc-text"> Policy Model</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#action-space"><span class="toc-text"> Action Space</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#reward-function"><span class="toc-text"> Reward Function</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%93%E6%9E%84%E5%8C%96%E6%94%BB%E5%87%BB%E7%9A%84%E4%BC%98%E7%82%B9%E5%92%8C%E6%9C%89%E6%95%88%E6%80%A7"><span class="toc-text"> 结构化攻击的优点和有效性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#android-application-manipulation"><span class="toc-text"> Android Application Manipulation</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%BB%93%E6%9E%9C%E8%AF%84%E4%BC%B0"><span class="toc-text"> 结果评估</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#dataset"><span class="toc-text"> Dataset</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#metrics"><span class="toc-text"> Metrics</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AE%9E%E9%AA%8C%E7%BB%93%E6%9E%9C"><span class="toc-text"> 实验结果</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%AF%B9%E6%88%91%E6%9C%89%E4%BB%80%E4%B9%88%E5%90%AF%E5%8F%91%E6%80%BB%E7%BB%93"><span class="toc-text"> 对我有什么启发（总结）</span></a></li></ol></li></ol>
    </article>
  
  
  <article class="card card-content">
    <div class="recent-posts-card">
  <div class="recent-posts-header">
    <i 
      class="iconfont icon-wenzhang_huaban" 
      style="padding-right: 2px;">
    </i>最近文章
  </div>
  <div class="recent-posts-list">
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2022-06-01</div>
        <a href="/Note-SoK-Demystifying-Binary-Lifters-Through-the-Lens-of-Downstream-Applications/"><div class="recent-posts-item-content">Note 《SoK Demystifying Binary Lifters Through the Lens of Downstream Applications》</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2022-05-04</div>
        <a href="/Rust%E7%B1%BB%E5%9E%8B%E7%B3%BB%E7%BB%9F%E5%9B%BE%E7%81%B5%E5%AE%8C%E5%A4%87%E7%9A%84%E8%AF%81%E6%98%8E/"><div class="recent-posts-item-content">Rust类型系统图灵完备的证明</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2022-04-13</div>
        <a href="/%E4%BB%8Epython%E8%B0%83%E7%94%A8rust-%E4%BD%BF%E7%94%A8rust%E5%8A%A0%E9%80%9F%E4%BD%A0%E7%9A%84python%E4%BB%A3%E7%A0%81/"><div class="recent-posts-item-content">从python调用rust-使用rust加速你的python代码</div></a>
      </div>
    
      <div class="recent-posts-item">
        <div class="recent-posts-item-title">2022-03-28</div>
        <a href="/%E5%A6%82%E4%BD%95%E7%94%A8%20Rust%20%E5%AE%9E%E7%8E%B0%E6%9C%B4%E7%B4%A0%E8%B4%9D%E5%8F%B6%E6%96%AF%E5%88%86%E7%B1%BB%E5%99%A8/"><div class="recent-posts-item-content">如何用 Rust 实现朴素贝叶斯分类器</div></a>
      </div>
    
  </div>
</div>
  </article>
  
  
</div>
            </aside>
          </div>
        </div>
      </div>
    </div>
     
    <footer class="footer">
  <div class="footer-container">
    <div>
      <div class="footer-dsc">
        <span>
          Copyright ©
          
            2020 -
          
          2022
        </span>
        &nbsp;
        <a 
          href="/" 
          class="footer-link">
          ch3nye's blog
        </a>
      </div>
    </div>

    
      <div class="footer-dsc">
        
          Powered by
          <a 
            href="https://hexo.io/" 
            class="footer-link" 
            target="_blank" 
            rel="nofollow noopener noreferrer">
            &nbsp;Hexo
          </a>
        
        
          <span>&nbsp;|&nbsp;</span>
        
        
          Theme -
          <a 
            href="https://github.com/theme-kaze" 
            class="footer-link" 
            target="_blank"
            rel="nofollow noopener noreferrer">
            &nbsp;Kaze
          </a>
        
      </div>
    
    
    
    
      <div class="footer-dsc">
        
          本站总访问量<span id="busuanzi_value_site_pv"></span>次
        
        
          <span>&nbsp;|&nbsp;</span>
        
        
          本站总访客数<span id="busuanzi_value_site_uv"></span>次
        
      </div>
      
    
<!-- Default Statcounter code for My Blog https://ch3nye.top -->
<script type="text/javascript">
var sc_project=12696483; 
var sc_invisible=1; 
var sc_security="0f70f90d"; 
</script>
<script type="text/javascript"
src="https://www.statcounter.com/counter/counter.js" async></script>
<noscript><div class="statcounter"><a title="Web Analytics"
href="https://statcounter.com/" target="_blank"><img class="statcounter"
src="https://c.statcounter.com/12696483/0/0f70f90d/1/" alt="Web Analytics"
referrerPolicy="no-referrer-when-downgrade"></a></div></noscript>
<!-- End of Statcounter Code -->
</footer> 
    
  <a 
    role="button" 
    id="scrollbutton" 
    class="basebutton" 
    aria-label="回到顶部">
    <i class="iconfont icon-arrowleft button-icon"></i>
  </a>

<a 
  role="button" 
  id="menubutton"
  aria-label="menu button"
  class="basebutton">
  <i class="iconfont icon-menu button-icon"></i>
</a>
<a 
  role="button" 
  id="popbutton" 
  class="basebutton" 
  aria-label="控制中心">
  <i class="iconfont icon-expand button-icon"></i>
</a>
<a 
  role="button" 
  id="darkbutton" 
  class="basebutton darkwidget" 
  aria-label="夜色模式">
  <i class="iconfont icon-weather button-icon"></i>
</a>
<a 
  role="button" 
  id="searchbutton" 
  class="basebutton searchwidget" 
  aria-label="搜索">
  <i class="iconfont icon-search button-icon"></i>
</a> 
     
     
      

  
  
    
<link rel="stylesheet" href="//cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css">

  
 
     
     
      <script>
  var addImgLayout = function () {
    var img = document.querySelectorAll('.post-content img')
    var i
    for (i = 0; i < img.length; i++) {
      var wrapper = document.createElement('a')
      wrapper.setAttribute('href', img[i].getAttribute('data-src'))
      wrapper.setAttribute('aria-label', 'illustration')
      wrapper.style.cssText =
        'width: 100%; display: flex; justify-content: center;'
      if (img[i].alt) wrapper.dataset.caption = img[i].alt
      wrapper.dataset.nolink = true
      img[i].before(wrapper)
      wrapper.append(img[i])
      var divWrap = document.createElement('div')
      divWrap.classList.add('gallery')
      wrapper.before(divWrap)
      divWrap.append(wrapper)
    }
    baguetteBox.run('.gallery')
  }
</script>
<script>
  loadScript(
    "/js/lib/lightbox/baguetteBox.min.js",
    addImgLayout
  )
</script>
 
     
     
    <script src="/js/main.js"></script> 
    
      <script> 
        loadScript('/js/lib/busuanzi.min.js') 
      </script>
     
    
      <script>
        var addLazyload = function () {
          var observer = lozad('.lozad', {
            load: function (el) {
              el.srcset = el.getAttribute('data-src')
            },
            loaded: function (el) {
              el.classList.add('loaded')
            },
          })
          observer.observe()
        }
      </script>
      <script>
        loadScript('/js/lib/lozad.min.js', addLazyload)
      </script>
     
    
      <script>
        var googleAnalytics = function () {
          window.dataLayer = window.dataLayer || []
          function gtag() {
            dataLayer.push(arguments)
          }
          gtag('js', new Date())
          gtag('config', 'G-WHGL11014T')
        }
    </script>
      <script>
        loadScript(
          'https://www.googletagmanager.com/gtag/js?id=' +
            'G-WHGL11014T',
          googleAnalytics
        )
      </script>
    
    
      <script>
        setTimeout(() => {localSearch("search.json")}, 0)
      </script>
    
  </body>
</html>
